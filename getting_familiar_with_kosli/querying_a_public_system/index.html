<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Cyber-dojo introduction # Cyber-dojo is an open source platform where teams can practice TDD in many different languages without any installation.
Cyber-dojo has a standard micro service architecture with a dozen or so git repositories (eg web, runner). Each git repository has its own CI pipeline producing a docker image.
These docker images run in two AWS environments called aws-beta and aws-prod.
In this tutorial you will learn how Kosli tracks &#34;life after git&#34;."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="Querying a public system"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://docs.kosli.com/getting_familiar_with_kosli/querying_a_public_system/"><title>Querying a public system | Kosli developer documentation</title><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=stylesheet href=/book.min.2209f42b4d823c04d7813187fe8e166480d9e57b244ba3efd71c2eed83326b5f.css integrity="sha256-Ign0K02CPATXgTGH/o4WZIDZ5XskS6Pv1xwu7YMya18=" crossorigin=anonymous><script defer src=/flexsearch.min.js></script>
<script defer src=/en.search.min.962f78c44028e355e115d72e69968ea37cbac911b7b3b0990770e0db6181f555.js integrity="sha256-li94xEAo41XhFdcuaZaOo3y6yRG3s7CZB3Dg22GB9VU=" crossorigin=anonymous></script>
<link rel=alternate type=application/rss+xml href=https://docs.kosli.com/getting_familiar_with_kosli/querying_a_public_system/index.xml title="Kosli developer documentation"></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>Kosli developer documentation</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><input type=checkbox id=section-88ce4fcfc81f5fbcc629e032a4440ec3 class=toggle checked>
<label for=section-88ce4fcfc81f5fbcc629e032a4440ec3 class="flex justify-between"><a href=https://docs.kosli.com/getting_familiar_with_kosli/>Getting Familiar with Kosli</a></label><ul><li><a href=https://docs.kosli.com/getting_familiar_with_kosli/installation/>Installing Kosli CLI</a><ul></ul></li><li><a href=https://docs.kosli.com/getting_familiar_with_kosli/querying_a_public_system/ class=active>Querying a public system</a><ul></ul></li><li><a href=https://docs.kosli.com/getting_familiar_with_kosli/simulating_a_devops_system/>Simulating a DevOps system</a><ul></ul></li></ul></li><li><input type=checkbox id=section-90d1aeee0e96e115d1edea3b994d19fb class=toggle>
<label for=section-90d1aeee0e96e115d1edea3b994d19fb class="flex justify-between"><a href=https://docs.kosli.com/tutorials/>Tutorials</a></label><ul><li><input type=checkbox id=section-7eca5fc2ae3a7a6d5837431d0a2728d1 class=toggle>
<label for=section-7eca5fc2ae3a7a6d5837431d0a2728d1 class="flex justify-between"><a href=https://docs.kosli.com/tutorials/github_actions_and_k8s/>GitHub Actions and k8s</a></label><ul><li><a href=https://docs.kosli.com/tutorials/github_actions_and_k8s/prerequisites/>Prerequisites</a></li><li><a href=https://docs.kosli.com/tutorials/github_actions_and_k8s/report_environment/>Report Environment</a></li><li><a href=https://docs.kosli.com/tutorials/github_actions_and_k8s/report_artifact/>Report Artifact</a></li><li><a href=https://docs.kosli.com/tutorials/github_actions_and_k8s/report_deployment/>Report Deployment</a></li></ul></li></ul></li><li><input type=checkbox id=section-dc8a1c63e6da60163016ce21cae1faa0 class=toggle>
<label for=section-dc8a1c63e6da60163016ce21cae1faa0 class="flex justify-between"><a href=https://docs.kosli.com/concepts/>Concepts</a></label><ul><li><a href=https://docs.kosli.com/concepts/environments/>Environments</a></li><li><a href=https://docs.kosli.com/concepts/pipelines/>Pipelines</a></li></ul></li><li><input type=checkbox id=section-3993beb65ef7e76a7dbe6e66c07255ac class=toggle>
<label for=section-3993beb65ef7e76a7dbe6e66c07255ac class="flex justify-between"><a href=https://docs.kosli.com/client_reference/>Kosli Commands</a></label><ul><li><a href=https://docs.kosli.com/client_reference/kosli/>kosli</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_approval_get/>kosli approval get</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_approval_ls/>kosli approval ls</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_artifact_get/>kosli artifact get</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_artifact_ls/>kosli artifact ls</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_assert_artifact/>kosli assert artifact</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_assert_bitbucket-pullrequest/>kosli assert bitbucket-pullrequest</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_assert_environment/>kosli assert environment</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_assert_github-pullrequest/>kosli assert github-pullrequest</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_assert_status/>kosli assert status</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_deployment_get/>kosli deployment get</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_deployment_ls/>kosli deployment ls</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_allowedartifacts_add/>kosli environment allowedartifacts add</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_declare/>kosli environment declare</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_diff/>kosli environment diff</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_get/>kosli environment get</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_inspect/>kosli environment inspect</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_log/>kosli environment log</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_ls/>kosli environment ls</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_report_ecs/>kosli environment report ecs</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_report_k8s/>kosli environment report k8s</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_report_lambda/>kosli environment report lambda</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_report_s3/>kosli environment report s3</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_report_server/>kosli environment report server</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_fingerprint/>kosli fingerprint</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_pipeline_approval_assert/>kosli pipeline approval assert</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_pipeline_approval_report/>kosli pipeline approval report</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_pipeline_approval_request/>kosli pipeline approval request</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_pipeline_artifact_report_creation/>kosli pipeline artifact report creation</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_pipeline_artifact_report_evidence_bitbucket-pullrequest/>kosli pipeline artifact report evidence bitbucket-pullrequest</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_pipeline_artifact_report_evidence_generic/>kosli pipeline artifact report evidence generic</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_pipeline_artifact_report_evidence_github-pullrequest/>kosli pipeline artifact report evidence github-pullrequest</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_pipeline_artifact_report_evidence_test/>kosli pipeline artifact report evidence test</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_pipeline_declare/>kosli pipeline declare</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_pipeline_deployment_report/>kosli pipeline deployment report</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_pipeline_inspect/>kosli pipeline inspect</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_pipeline_ls/>kosli pipeline ls</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_status/>kosli status</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_version/>kosli version</a></li></ul></li><li><input type=checkbox id=section-d06928ff9c11121b26f141ced850796c class=toggle>
<label for=section-d06928ff9c11121b26f141ced850796c class="flex justify-between"><a href=https://docs.kosli.com/helm/>Helm</a></label><ul><li><a href=https://docs.kosli.com/helm/helm_chart/>Helm Chart</a></li></ul></li><li><a href=https://docs.kosli.com/ci-defaults/>Defaulted command flags from CI</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Querying a public system</strong>
<label for=toc-control></label></div></header><article class=markdown><h1 id=cyber-dojo-introduction>Cyber-dojo introduction
<a class=anchor href=#cyber-dojo-introduction>#</a></h1><p><a href=https://cyber-dojo.org>Cyber-dojo</a> is an open source platform where teams can practice TDD in
many different languages without any installation.</p><p>Cyber-dojo has a standard micro service architecture with a dozen or so git repositories
(eg <a href=https://github.com/cyber-dojo/web>web</a>, <a href=https://github.com/cyber-dojo/runner>runner</a>).
Each git repository has its own CI pipeline producing a docker image.</p><p>These docker images run in two AWS environments called <a href=https://app.merkely.com/cyber-dojo/environments/aws-beta>aws-beta</a>
and <a href=https://app.merkely.com/cyber-dojo/environments/aws-prod>aws-prod</a>.</p><p>In this tutorial you will learn how Kosli tracks "life after git". In other words, all the dynamic events
after a Cyber-dojo git commit:</p><ul><li>In the CI-pipeline (eg building docker image, running unit tests, deploying, etc)</li><li>In the AWS runtime environment (eg blue-green rollover, instance scaling, etc)</li></ul><h1 id=getting-started>Getting started
<a class=anchor href=#getting-started>#</a></h1><p>If you want to you can run the actual commands in this tutorial in a bash terminal.
You need to:</p><ul><li><a href=../installation>Install Kosli</a></li><li><a href=https://app.kosli.com>Sign up to Kosli with Github</a></li><li><a href=../installation#getting-your-kosli-api-token>Get your Kosli API token</a> and set the following environment variables:</li></ul><div class="highlight command"><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>export KOSLI_API_TOKEN<span style=color:#f92672>=</span>&lt;put your kosli API token here&gt;
</span></span><span style=display:flex><span>export KOSLI_OWNER<span style=color:#f92672>=</span>cyber-dojo
</span></span></code></pre></div><h1 id=pipeline-events>Pipeline events
<a class=anchor href=#pipeline-events>#</a></h1><p>We will follow a git commit <a href=https://github.com/cyber-dojo/runner/commit/16d9990ad23a40eecaf087abac2a58a2d2a4b3f4>16d9990</a>
to the <code>runner</code> repository through its CI-pipeline.</p><p>The name of a git repository, CI-pipeline and Kosli pipeline does not need to match. But it makes
life a lot easier if the relationship is clear.</p><p>We can list the Kosli pipelines so we can match up the name with the git repository name.</p><div class="highlight command"><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kosli pipeline ls
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>NAME                    DESCRIPTION                         VISIBILITY
</span></span><span style=display:flex><span>creator                 UX <span style=color:#66d9ef>for</span> Group/Kata creation          public
</span></span><span style=display:flex><span>custom-start-points     Custom exercises choices            public
</span></span><span style=display:flex><span>dashboard               UX <span style=color:#66d9ef>for</span> a group practice dashboard   public
</span></span><span style=display:flex><span>differ                  Diff files from two traffic-lights  public
</span></span><span style=display:flex><span>exercises-start-points  Exercises choices                   public
</span></span><span style=display:flex><span>languages-start-points  Language+TestFramework choices      public
</span></span><span style=display:flex><span>nginx                   Reverse proxy                       public
</span></span><span style=display:flex><span>repler                  REPL <span style=color:#66d9ef>for</span> Python images              public
</span></span><span style=display:flex><span>runner                  Test runner                         public
</span></span><span style=display:flex><span>saver                   Group/Kata model+persistence        public
</span></span><span style=display:flex><span>shas                    UX <span style=color:#66d9ef>for</span> git+image shas               public
</span></span><span style=display:flex><span>web                     UX <span style=color:#66d9ef>for</span> practicing TDD               public
</span></span></code></pre></div><p>In this case we have a Kosli pipeline named <code>runner</code>.</p><p>Lets find out which artifact was built from this commit.</p><div class="highlight command"><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kosli artifact get runner<span style=color:#f92672>{</span>commit<span style=color:#f92672>=</span>16d9990<span style=color:#f92672>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>Name:        cyberdojo/runner:16d9990
</span></span><span style=display:flex><span>State:       COMPLIANT
</span></span><span style=display:flex><span>Git commit:  16d9990ad23a40eecaf087abac2a58a2d2a4b3f4
</span></span><span style=display:flex><span>Build URL:   https://github.com/cyber-dojo/runner/actions/runs/2902808452
</span></span><span style=display:flex><span>Commit URL:  https://github.com/cyber-dojo/runner/commit/16d9990ad23a40eecaf087abac2a58a2d2a4b3f4
</span></span><span style=display:flex><span>Created at:  <span style=color:#ae81ff>22</span> Aug <span style=color:#ae81ff>22</span> 11:35 CEST • <span style=color:#ae81ff>8</span> days ago
</span></span><span style=display:flex><span>Approvals:   None
</span></span><span style=display:flex><span>Deployments:
</span></span><span style=display:flex><span>     <span style=color:#75715e>#18 Reported deployment to aws-beta at 22 Aug 22 11:37 CEST (Exited on 24 Aug 22 18:05 CEST)</span>
</span></span><span style=display:flex><span>     <span style=color:#75715e>#19 Reported deployment to aws-prod at 22 Aug 22 11:38 CEST (Exited on 24 Aug 22 18:12 CEST)</span>
</span></span><span style=display:flex><span>Evidence:
</span></span><span style=display:flex><span>     branch-coverage:  COMPLIANT
</span></span></code></pre></div><p>We can see the Name of the artifact, including version number. Cyber-dojo uses the short commit
sha as version number, but semantic or no versioning can also be used.
TODO: State COMPLIANT??
The Build and Commit URL points back to the source code and the build system. We can see
when the artifact was built and that there are no Approvals for this artifact.
This artifact was deployed to both aws-beta and aws-prod and exited 2 days later.</p><p>TODO:
We need a <code>kosli artifact get runner{commit=16d9990}</code> command
The output of the command that is listed here is missing the artifact sha. Should it also
contain a URL to the artifact?
<a href=https://app.merkely.com/cyber-dojo/pipelines/runner/artifacts/9af401c4350b21e3f1df17d6ad808da43d9646e75b6da902cc7c492bcfb9c625>https://app.merkely.com/cyber-dojo/pipelines/runner/artifacts/9af401c4350b21e3f1df17d6ad808da43d9646e75b6da902cc7c492bcfb9c625</a></p><ul class=contents></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){document.querySelectorAll("div.command").forEach(e=>{let t=document.createElement("div"),n=document.createTextNode("Copied!");t.appendChild(n),e.appendChild(t),t.classList.add("copiedText"),e.addEventListener("click",function(){if(navigator.clipboard){let n=e.querySelector("code");navigator.clipboard.writeText(n.innerText),t.classList.add("visible"),setTimeout(()=>{t.classList.remove("visible")},1500)}})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div></main><div class=top-header><div class="container flex"><div class=docs-logo><a href=/><img src=/kosli-docs-logo-white.svg alt="Kosli docs logo"></a></div><div class=separator></div><div class=back-to-site><a href=https://www.kosli.com target=_blank><span class=left-carret>&lt;</span> Back to Website</a></div></div></div></body></html>