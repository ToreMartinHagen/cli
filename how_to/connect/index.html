<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Connect your pipeline events # Kosli allows you to connect the development world (commits, builds, tests, approvals, deployments) with whatâ€™s happening in operations. There is a variety of commands that let you report all the necessary information to Kosli and - relying on automatically calculated fingerprints of your artifacts - match it with the environments.
Create a pipeline # In order to be able to report artifacts to Kosli you need to create a Kosli pipeline first."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:image" content="https://docs.kosli.com/images/kosli.jpg"><meta name=twitter:image content="https://docs.kosli.com/images/kosli.jpg"><meta property="og:title" content><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://docs.kosli.com/how_to/connect/"><title>Connect</title><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=stylesheet href=/book.min.e789a4fc4414484ea0dd1204f9a7cec2abc5e562551a43064ab3f6bca33dd66a.css integrity="sha256-54mk/EQUSE6g3RIE+afOwqvF5WJVGkMGSrP2vKM91mo=" crossorigin=anonymous><script defer src=/flexsearch.min.js></script>
<script defer src=/en.search.min.3dd7732ec83974dfc1bc766b75e5c223734d4875fb7991f6a2ecaebb04813e58.js integrity="sha256-PddzLsg5dN/BvHZrdeXCI3NNSHX7eZH2ouyuuwSBPlg=" crossorigin=anonymous></script>
<script src=https://cdn.usefathom.com/script.js data-site=AUFUAQWT data-excluded-domains=localhost defer></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>Kosli developer documentation</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><input type=checkbox id=section-8d07877860004719ef46751318e056d1 class=toggle>
<label for=section-8d07877860004719ef46751318e056d1 class="flex justify-between"><a href=https://docs.kosli.com/introducing_kosli/>Introducing Kosli</a></label><ul><li><a href=https://docs.kosli.com/introducing_kosli/organizations/>Organizations</a></li><li><a href=https://docs.kosli.com/introducing_kosli/environments/>Environments</a></li><li><a href=https://docs.kosli.com/introducing_kosli/pipelines/>Pipelines</a></li><li><a href=https://docs.kosli.com/introducing_kosli/fingerprint/>Fingerprint</a></li><li><a href=https://docs.kosli.com/introducing_kosli/cli/>CLI</a></li><li><a href=https://docs.kosli.com/introducing_kosli/web_ui/>Web UI</a></li></ul></li><li><input type=checkbox id=section-acdc30ff5cf57e4ff3a5b04fe43650db class=toggle>
<label for=section-acdc30ff5cf57e4ff3a5b04fe43650db class="flex justify-between"><a href=https://docs.kosli.com/getting_started/>Getting started</a></label><ul><li><a href=https://docs.kosli.com/getting_started/getting_started_with_kosli/>Quick start</a></li><li><a href=https://docs.kosli.com/getting_started/installation/>Install Kosli</a></li><li><a href=https://docs.kosli.com/getting_started/use_kosli_in_ci_systems/>Use Kosli in CI Systems</a></li></ul></li><li><input type=checkbox id=section-fdba2124b9f6bc01f478608f07a6e592 class=toggle>
<label for=section-fdba2124b9f6bc01f478608f07a6e592 class="flex justify-between"><a href=https://docs.kosli.com/use_cases/>Use cases</a></label><ul><li><a href=https://docs.kosli.com/use_cases/following_a_git_commit_to_runtime_environments/>Following a git commit to runtime environments</a><ul></ul></li><li><a href=https://docs.kosli.com/use_cases/tracing_a_production_incident_back_to_git_commits/>Tracing a production incident back to git commits</a><ul></ul></li><li><a href=https://docs.kosli.com/use_cases/simulating_a_devops_system/>Simulating a DevOps system</a><ul></ul></li></ul></li><li><input type=checkbox id=section-23c01066495116db89ec68655dfc73ed class=toggle checked>
<label for=section-23c01066495116db89ec68655dfc73ed class="flex justify-between"><a href=https://docs.kosli.com/how_to/>How to</a></label><ul><li><a href=https://docs.kosli.com/how_to/record/>Record</a></li><li><a href=https://docs.kosli.com/how_to/connect/ class=active>Connect</a></li><li><a href=https://docs.kosli.com/how_to/search/>Search</a></li></ul></li><li><input type=checkbox id=section-3993beb65ef7e76a7dbe6e66c07255ac class=toggle>
<label for=section-3993beb65ef7e76a7dbe6e66c07255ac class="flex justify-between"><a href=https://docs.kosli.com/client_reference/>Reference</a></label><ul><li><a href=https://docs.kosli.com/client_reference/kosli/>kosli</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_approval_get/>kosli approval get</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_approval_ls/>kosli approval ls</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_artifact_get/>kosli artifact get</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_artifact_ls/>kosli artifact ls</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_assert_artifact/>kosli assert artifact</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_assert_bitbucket-pullrequest/>kosli assert bitbucket-pullrequest</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_assert_environment/>kosli assert environment</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_assert_github-pullrequest/>kosli assert github-pullrequest</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_assert_status/>kosli assert status</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_completion/>kosli completion</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_deployment_get/>kosli deployment get</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_deployment_ls/>kosli deployment ls</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_allowedartifacts_add/>kosli environment allowedartifacts add</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_declare/>kosli environment declare</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_diff/>kosli environment diff</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_get/>kosli environment get</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_inspect/>kosli environment inspect</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_log/>kosli environment log</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_ls/>kosli environment ls</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_rename/>kosli environment rename</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_report_docker/>kosli environment report docker</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_report_ecs/>kosli environment report ecs</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_report_k8s/>kosli environment report k8s</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_report_lambda/>kosli environment report lambda</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_report_s3/>kosli environment report s3</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_report_server/>kosli environment report server</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_expect_deployment/>kosli expect deployment</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_fingerprint/>kosli fingerprint</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_pipeline_approval_assert/>kosli pipeline approval assert</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_pipeline_approval_report/>kosli pipeline approval report</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_pipeline_approval_request/>kosli pipeline approval request</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_pipeline_artifact_report_creation/>kosli pipeline artifact report creation</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_pipeline_artifact_report_evidence_bitbucket-pullrequest/>kosli pipeline artifact report evidence bitbucket-pullrequest</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_pipeline_artifact_report_evidence_generic/>kosli pipeline artifact report evidence generic</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_pipeline_artifact_report_evidence_github-pullrequest/>kosli pipeline artifact report evidence github-pullrequest</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_pipeline_artifact_report_evidence_test/>kosli pipeline artifact report evidence test</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_pipeline_declare/>kosli pipeline declare</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_pipeline_inspect/>kosli pipeline inspect</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_pipeline_ls/>kosli pipeline ls</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_search/>kosli search</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_status/>kosli status</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_version/>kosli version</a></li></ul></li><li><a href=https://docs.kosli.com/faq/>Frequently asked questions</a><ul></ul></li><li><a href=https://docs.kosli.com/helm/>Kubernetes Reporter Helm Chart</a><ul><li><a href=https://docs.kosli.com/helm/helm_chart/>Kubernetes Reporter Helm Chart</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Connect</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><h4 class=toc-title>On this page:</h4><nav id=TableOfContents><ul><li><a href=#connect-your-pipeline-events>Connect your pipeline events</a><ul><li><a href=#create-a-pipeline>Create a pipeline</a></li><li><a href=#report-artifacts>Report artifacts</a></li><li><a href=#report-evidences>Report evidences</a></li><li><a href=#report-approvals>Report approvals</a></li><li><a href=#deployments>Deployments</a></li></ul></li></ul></nav></aside></header><div class=content-container><article class=markdown><h1 id=connect-your-pipeline-events>Connect your pipeline events
<a class=anchor href=#connect-your-pipeline-events>#</a></h1><p>Kosli allows you to connect the development world (commits, builds, tests, approvals, deployments) with whatâ€™s happening in operations. There is a variety of commands that let you report all the necessary information to Kosli and - relying on automatically calculated fingerprints of your artifacts - match it with the environments.</p><h2 id=create-a-pipeline>Create a pipeline
<a class=anchor href=#create-a-pipeline>#</a></h2><p>In order to be able to report artifacts to Kosli you need to create a Kosli <a href=/introducing_kosli/pipelines>pipeline</a> first. When you create a pipeline you also define expected controls - a list of evidences you need to be reported in order for the artifact to become compliant. Use <code>--template</code> flag to provide the list of requirements.</p><p>Later, when reporting evidences for specific control you will use the same name you used in template to identify which evidence you are reporting.</p><p>It is a normal practice to include <code>kosli pipeline declare</code> command in the same pipeline you use to build the artifact you want to report to that Kosli pipeline. None of the previously reported artifacts will be overwritten or lost. And if you change the template, by adding or removing required evidence, it won't affect the compliancy status of existing artifacts.</p><h3 id=example>Example
<a class=anchor href=#example>#</a></h3><pre tabindex=0><code># create/update a Kosli pipeline
kosli pipeline declare \
	--pipeline yourPipelineName \
	--description yourPipelineDescription \
  --visibility private OR public \
	--template artifact,unit-test,pull-request,code-coverage \
	--api-token yourAPIToken \
	--owner yourOrgName
</code></pre><h2 id=report-artifacts>Report artifacts
<a class=anchor href=#report-artifacts>#</a></h2><p>To report an artifact you need either the artifact available while running reporting command, and use <code>--artifact-type</code> flag to make it possible for the tool to calculate the fingerprint OR you need a fingerprint of the artifact calculated separately using <a href=/client_reference/kosli_fingerprint/>kosli fingerprint</a> command. You also need to provide the name of the Kosli pipeline you want to report to.</p><p>You also should provide long enough git history so Kosli can generate a list of commits that are part of the new artifact (that means at least until the commit of the previously built artifact). If you use shallow clone in your CI Kosli won't be able to generate the list but the command will NOT fail.</p><p>Fingerprint (sha256 checksum of the file/directory/docker image) of the artifact will be stored in Kosli. The fingerprint can't be changed, it becomes a unique identifier of the artifact in Kosli, used - among other things - to connect it with the recorded environment. Fingerprints of all the running artifacts, recorded with Kosli CLI are also stored and compared with fingerprints of the artifacts you have built and reported to Kosli so you always know if you're running things you have no provenance of.</p><p>Some of the required flags will be automatically resolved if you're using one of the <a href=/getting_started/use_kosli_in_ci_systems/>supported CI systems
</a>.</p><h3 id=example-1>Example
<a class=anchor href=#example-1>#</a></h3><pre tabindex=0><code># Report to a Kosli pipeline that a file type artifact has been created
kosli pipeline artifact report creation FILE.tgz \
	--api-token yourApiToken \
	--artifact-type file \
	--build-url https://exampleci.com \
	--commit-url https://github.com/YourOrg/YourProject/commit/yourCommitShaThatThisArtifactWasBuiltFrom \
	--git-commit yourCommitShaThatThisArtifactWasBuiltFrom \
	--owner yourOrgName \
	--pipeline yourPipelineName 

# Report to a Kosli pipeline that an artifact with a provided fingerprint (sha256) has been created
kosli pipeline artifact report creation \
	--api-token yourApiToken \
	--build-url https://exampleci.com \
	--commit-url https://github.com/YourOrg/YourProject/commit/yourCommitShaThatThisArtifactWasBuiltFrom \
	--git-commit yourCommitShaThatThisArtifactWasBuiltFrom \
	--owner yourOrgName \
	--pipeline yourPipelineName \
	--sha256 yourSha256 
</code></pre><p>See <a href=/client_reference/kosli_pipeline_artifact_report_creation/>kosli pipeline artifact report creation</a> for more details.</p><h2 id=report-evidences>Report evidences
<a class=anchor href=#report-evidences>#</a></h2><p>Whenever an event related to one of your evidences happens you should report it to Kosli.</p><p>Currently we support following types of evidences:</p><h3 id=pull-request>Pull request
<a class=anchor href=#pull-request>#</a></h3><p>If you use GitHub or Bitbucket you can use Kosli to verify if the merge commit you used to build your artifact comes from a pull request. Remember to add the pull request evidence to your <a href=/how_to/connect/#create-a-pipeline>pipeline template</a> and use the same label for <code>--evidence-type</code> you provided in a <code>template</code></p><p>If there is no pull request for given commit the evidence will be reported as incompliant and the pipeline will continue. You can choose to fail the pipeline altogether in case pull request is missing - use <code>--assert</code> flag to do that.</p><p>There are two different commands for that, depending on your CI.</p><p>For GitHub: <a href=/client_reference/kosli_pipeline_artifact_report_evidence_github-pullrequest/>kosli pipeline artifact report evidence github-pullrequest</a> along regular flags, you need to provide:</p><ul><li><code>--github-org</code></li><li><code>--github-token</code> your Github personal access token.</li></ul><p>For Bitbucket: <a href=/client_reference/kosli_pipeline_artifact_report_evidence_bitbucket-pullrequest/>kosli pipeline artifact report evidence bitbucket-pullrequest</a> along regular flags, you need to provide:</p><ul><li><code>--bitbucket-password</code> - you need to use an api token which is the "App password" you create under "Personal Settings", keep in mind that api tokens you create under "Manage account" won't work for basic auth</li><li><code>--bitbucket-username</code> - you cannot user your email address you use to log in, you have an actual username under "Personal Settings")</li><li><code>--bitbucket-workspace</code></li></ul><h3 id=junit-test>JUnit test
<a class=anchor href=#junit-test>#</a></h3><p>If you use JUnit to run your test you can use <code>kosli pipeline artifact report evidence test</code> command to analyze the results and provide it to Kosli. Remember to add the junit test evidence to your <a href=/how_to/connect/#create-a-pipeline>pipeline template</a> and use the same label for <code>--evidence-type</code> you provided in a <code>template</code></p><h3 id=example-2>Example
<a class=anchor href=#example-2>#</a></h3><pre tabindex=0><code># report a JUnit test evidence about a file artifact:
kosli pipeline artifact report evidence test FILE.tgz \
	--artifact-type file \
	--evidence-type yourEvidenceType \
	--pipeline yourPipelineName \
	--build-url https://exampleci.com \
	--api-token yourAPIToken \
	--owner yourOrgName	\
	--results-dir yourFolderWithJUnitResults

# report a JUnit test evidence about an artifact using an available Sha256 digest:
kosli pipeline artifact report evidence test \
	--sha256 yourSha256 \
	--evidence-type yourEvidenceType \
	--pipeline yourPipelineName \
	--build-url https://exampleci.com \
	--api-token yourAPIToken \
	--owner yourOrgName	\
	--results-dir yourFolderWithJUnitResults
</code></pre><p><a href=/client_reference/kosli_pipeline_artifact_report_evidence_test/>junit test</a></p><h3 id=generic>Generic
<a class=anchor href=#generic>#</a></h3><h2 id=report-approvals>Report approvals
<a class=anchor href=#report-approvals>#</a></h2><p>Whenever a given artifact is ready to be deployed you may need an additional manual approval from authorized person. This is something that can't alway be automated, but you can use Kosli to request such an approval, and later record it, so the information about decisions made outside of your CI system won't be lost. The list of commits between current and previous approval will be generated, which allows you to track a set of changes that are being approved.</p><p>See <a href=/client_reference/kosli_pipeline_approval_report/>kosli pipeline approval report</a> and <a href=/client_reference/kosli_pipeline_approval_request/>kosli pipeline approval request</a> for more details.</p><h3 id=quick-note-about-a-commit-list>Quick note about a commit list
<a class=anchor href=#quick-note-about-a-commit-list>#</a></h3><p>When reporting or requesting an approval one has to keep in mind that <code>oldest-commit</code> has to be an ancestor of <code>newest-commit</code>.</p><p>It's easy to verify locally in the repository using:</p><div class="highlight command"><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>git merge-base --is-ancestor &lt;oldest-commit&gt; &lt;newest-commit&gt;
</span></span><span style=display:flex><span>echo $?
</span></span></code></pre></div><p><code>echo $?</code> checks the exit code of previous command so it's important you run it directly after <code>git merge-base &lt;...></code> command.</p><p>Exit code 0 means <code>oldest-commit</code> is an ancestor of <code>newest-commit</code> and your kosli approval command will work. If the exit code is different than 0 then we won't be able to generate a list of commits needed for an approval and the command will fail.</p><p>To be able to trace back the history of your commits we need a complete repository history to be available - in your CI pipelines it'll likely mean you have to explicitly check out the whole history (many CI tools checkout just a latest version by default).</p><p>In GitHub Actions you'd need to modify the checkout step by adding fetch-depth option:</p><pre tabindex=0><code>steps:
    - uses: actions/checkout@v2
      with:
        fetch-depth: 0
</code></pre><h2 id=deployments>Deployments
<a class=anchor href=#deployments>#</a></h2><p>The last important piece of information, when it comes to artifacts are deployments. Whenever you (likely with the use of your CI system) deploy an artifact to an environment you should record that information to Kosli. So when you check the status of your environments you know not only what is running there, but also how did it get there. It's an easy way of detecting a manual change was introduced.</p></article><aside class=book-toc><div class=book-toc-content><h4 class=toc-title>On this page:</h4><nav id=TableOfContents><ul><li><a href=#connect-your-pipeline-events>Connect your pipeline events</a><ul><li><a href=#create-a-pipeline>Create a pipeline</a></li><li><a href=#report-artifacts>Report artifacts</a></li><li><a href=#report-evidences>Report evidences</a></li><li><a href=#report-approvals>Report approvals</a></li><li><a href=#deployments>Deployments</a></li></ul></li></ul></nav></div></aside></div><footer class=book-footer><hr><div class=footer-grid><div><h3 class=h5-style>Get started for FREE!<br>Sign up GitHub.<br>Easy!</h3><a class="btn btn-main" href=https://app.kosli.com target=_blank>Sign up</a></div><div><h3 class=h5-style>Share your feedback on the docs so we can make them easier for you to use</h3><a href=https://www.kosli.com/community/ target=_blank class="btn btn-secondary">Join the Slack Community</a></div><div><h3 class=h5-style>Stuck with something?</h3><p>We have an open Slack channel where you can get in touch with the Kosli team and other users.</p><p><a href=https://www.kosli.com/community/ target=_blank>Ask the Kosli Slack community</a></p><p><a href=mailto:info@kosli.com>Email support</a></p></div></div><hr><div class="secondary-footer flex align-center flex-wrap" style=gap:40px><div><img src=/images/kosli-logo.svg alt="Kosli Logo"></div><div>Â© 2022 Kosli Inc.</div><div><a href=https://www.kosli.com target=_blank>kosli.com</a></div><div><a href=https://www.kosli.com/privacy-policy/ target=_blank>Privacy</a></div><div><a href=https://www.kosli.com/contact/ target=_blank>Contact Kosli</a></div><div><a href=https://www.kosli.com/pricing/ target=_blank>Pricing</a></div><div><a href=https://www.kosli.com/blog/ target=_blank>Blog</a></div><div><a href=https://www.kosli.com/about/ target=_blank>About</a></div></div><script>(function(){document.querySelectorAll("div.command").forEach(e=>{let t=document.createElement("div"),n=document.createTextNode("copied!");t.appendChild(n),e.appendChild(t),t.classList.add("copiedText"),e.addEventListener("click",function(){if(navigator.clipboard){let n=e.querySelector("code");navigator.clipboard.writeText(n.textContent),t.classList.add("visible"),setTimeout(()=>{t.classList.remove("visible")},1500)}})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div></main><div class=top-header><div class="container flex"><div class=docs-logo><a href=/><img src=/kosli-docs-logo-white.svg alt="Kosli docs logo"></a></div><div class=separator></div></div></div></body></html>