<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Tracing a production incident back to git commits # In this 5 minute tutorial you'll learn how Kosli can track a production incident in Cyber-dojo back to git commits.
Something has gone wrong and https://cyber-dojo.org is displaying a 500 error!
It was working an hour ago. What has happened in the last hour?
Start with the environment # https://cyber-dojo.org is running in an AWS environment that reports to Kosli as aws-prod."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:image" content="https://docs.kosli.com/images/kosli.jpg"><meta name=twitter:image content="https://docs.kosli.com/images/kosli.jpg"><meta property="og:title" content><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://docs.kosli.com/use_cases/tracing_a_production_incident_back_to_git_commits/"><title>Tracing a production incident back to git commits</title><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=stylesheet href=/book.min.48e8d3d7ae8a2962a1271d93fe029a597b87e17150a5a5b2df9808e002beb524.css integrity="sha256-SOjT166KKWKhJx2T/gKaWXuH4XFQpaWy35gI4AK+tSQ=" crossorigin=anonymous><script defer src=/flexsearch.min.js></script>
<script defer src=/en.search.min.0c0bf74d19749d1d459d21ea2ee4767b481e66fa46651b881d25ff5081598802.js integrity="sha256-DAv3TRl0nR1FnSHqLuR2e0geZvpGZRuIHSX/UIFZiAI=" crossorigin=anonymous></script>
<script src=https://cdn.usefathom.com/script.js data-site=AUFUAQWT data-excluded-domains=localhost defer></script>
<link rel=alternate type=application/rss+xml href=https://docs.kosli.com/use_cases/tracing_a_production_incident_back_to_git_commits/index.xml title="Kosli developer documentation"></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>Kosli developer documentation</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><input type=checkbox id=section-8d07877860004719ef46751318e056d1 class=toggle>
<label for=section-8d07877860004719ef46751318e056d1 class="flex justify-between"><a href=https://docs.kosli.com/introducing_kosli/>Introducing Kosli</a></label><ul><li><a href=https://docs.kosli.com/introducing_kosli/organizations/>Organizations</a></li><li><a href=https://docs.kosli.com/introducing_kosli/environments/>Environments</a></li><li><a href=https://docs.kosli.com/introducing_kosli/pipelines/>Pipelines</a></li><li><a href=https://docs.kosli.com/introducing_kosli/fingerprint/>Fingerprint</a></li><li><a href=https://docs.kosli.com/introducing_kosli/cli/>CLI</a></li><li><a href=https://docs.kosli.com/introducing_kosli/web_ui/>Web UI</a></li></ul></li><li><input type=checkbox id=section-acdc30ff5cf57e4ff3a5b04fe43650db class=toggle>
<label for=section-acdc30ff5cf57e4ff3a5b04fe43650db class="flex justify-between"><a href=https://docs.kosli.com/getting_started/>Getting started</a></label><ul><li><a href=https://docs.kosli.com/getting_started/getting_started_with_kosli/>Getting started with Kosli</a></li><li><a href=https://docs.kosli.com/getting_started/installation/>Install Kosli</a></li><li><a href=https://docs.kosli.com/getting_started/use_kosli_in_ci_systems/>Use Kosli in CI Systems</a></li></ul></li><li><input type=checkbox id=section-fdba2124b9f6bc01f478608f07a6e592 class=toggle checked>
<label for=section-fdba2124b9f6bc01f478608f07a6e592 class="flex justify-between"><a href=https://docs.kosli.com/use_cases/>Use cases</a></label><ul><li><a href=https://docs.kosli.com/use_cases/following_a_git_commit_to_runtime_environments/>Following a git commit to runtime environments</a><ul></ul></li><li><a href=https://docs.kosli.com/use_cases/tracing_a_production_incident_back_to_git_commits/ class=active>Tracing a production incident back to git commits</a><ul></ul></li><li><a href=https://docs.kosli.com/use_cases/simulating_a_devops_system/>Simulating a DevOps system</a><ul></ul></li></ul></li><li><input type=checkbox id=section-23c01066495116db89ec68655dfc73ed class=toggle>
<label for=section-23c01066495116db89ec68655dfc73ed class="flex justify-between"><a href=https://docs.kosli.com/how_to/>How to</a></label><ul><li><a href=https://docs.kosli.com/how_to/record/>Record</a></li><li><a href=https://docs.kosli.com/how_to/connect/>Connect</a></li><li><a href=https://docs.kosli.com/how_to/search/>Search</a></li></ul></li><li><input type=checkbox id=section-3993beb65ef7e76a7dbe6e66c07255ac class=toggle>
<label for=section-3993beb65ef7e76a7dbe6e66c07255ac class="flex justify-between"><a href=https://docs.kosli.com/client_reference/>Reference</a></label><ul><li><a href=https://docs.kosli.com/client_reference/kosli/>kosli</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_approval_get/>kosli approval get</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_approval_ls/>kosli approval ls</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_artifact_get/>kosli artifact get</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_artifact_ls/>kosli artifact ls</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_assert_artifact/>kosli assert artifact</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_assert_bitbucket-pullrequest/>kosli assert bitbucket-pullrequest</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_assert_environment/>kosli assert environment</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_assert_github-pullrequest/>kosli assert github-pullrequest</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_assert_status/>kosli assert status</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_completion/>kosli completion</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_deployment_get/>kosli deployment get</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_deployment_ls/>kosli deployment ls</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_allowedartifacts_add/>kosli environment allowedartifacts add</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_declare/>kosli environment declare</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_diff/>kosli environment diff</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_get/>kosli environment get</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_inspect/>kosli environment inspect</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_log/>kosli environment log</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_ls/>kosli environment ls</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_report_docker/>kosli environment report docker</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_report_ecs/>kosli environment report ecs</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_report_k8s/>kosli environment report k8s</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_report_lambda/>kosli environment report lambda</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_report_s3/>kosli environment report s3</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_environment_report_server/>kosli environment report server</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_expect_deployment/>kosli expect deployment</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_fingerprint/>kosli fingerprint</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_pipeline_approval_assert/>kosli pipeline approval assert</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_pipeline_approval_report/>kosli pipeline approval report</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_pipeline_approval_request/>kosli pipeline approval request</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_pipeline_artifact_report_creation/>kosli pipeline artifact report creation</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_pipeline_artifact_report_evidence_bitbucket-pullrequest/>kosli pipeline artifact report evidence bitbucket-pullrequest</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_pipeline_artifact_report_evidence_generic/>kosli pipeline artifact report evidence generic</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_pipeline_artifact_report_evidence_github-pullrequest/>kosli pipeline artifact report evidence github-pullrequest</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_pipeline_artifact_report_evidence_test/>kosli pipeline artifact report evidence test</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_pipeline_declare/>kosli pipeline declare</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_pipeline_inspect/>kosli pipeline inspect</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_pipeline_ls/>kosli pipeline ls</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_status/>kosli status</a></li><li><a href=https://docs.kosli.com/client_reference/kosli_version/>kosli version</a></li></ul></li><li><input type=checkbox id=section-d06928ff9c11121b26f141ced850796c class=toggle>
<label for=section-d06928ff9c11121b26f141ced850796c class="flex justify-between"><a href=https://docs.kosli.com/helm/>Helm</a></label><ul><li><a href=https://docs.kosli.com/helm/helm_chart/>Helm Chart</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Tracing a production incident back to git commits</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#tracing-a-production-incident-back-to-git-commits>Tracing a production incident back to git commits</a><ul><li><a href=#start-with-the-environment>Start with the environment</a></li><li><a href=#dig-into-the-artifact>Dig into the artifact</a></li><li><a href=#follow-to-the-commit>Follow to the commit</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=tracing-a-production-incident-back-to-git-commits>Tracing a production incident back to git commits
<a class=anchor href=#tracing-a-production-incident-back-to-git-commits>#</a></h1><p>In this 5 minute tutorial you'll learn how Kosli can track a production incident in Cyber-dojo back to git commits.</p><p>Something has gone wrong and <a href=https://cyber-dojo.org target=_blank>https://cyber-dojo.org</a> is displaying a 500 error!</p><figure><img src=/images/cyber-dojo-prod-500-large.png alt="Prod cyber-dojo is down with a 500" width=90%></figure><p>It was working an hour ago. What has happened in the last hour?</p><h2 id=start-with-the-environment>Start with the environment
<a class=anchor href=#start-with-the-environment>#</a></h2><p><a href=https://cyber-dojo.org target=_blank>https://cyber-dojo.org</a> is running in an AWS environment
that reports to Kosli as <code>aws-prod</code>.<br>Get a log of this environment's changes:</p><div class="highlight command"><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kosli env log aws-prod --long
</span></span></code></pre></div><p>You will see more than 177 snapshots because
<code>aws-prod</code> has moved on since this incident (it has been resolved with new
commits which have created new deployments). To get the same output as we have
you can set the interval for the command:</p><div class="highlight command"><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kosli env log aws-prod --long 175..177
</span></span></code></pre></div><div class="highlight light-console"><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plaintext data-lang=plaintext><span style=display:flex><span>SNAPSHOT  EVENT                                                                          PIPELINE  DEPLOYMENTS
</span></span><span style=display:flex><span>#177      Artifact: 274425519734.dkr.ecr.eu-central-1.amazonaws.com/creator:31dee35      creator   #87 
</span></span><span style=display:flex><span>          Fingerprint: 5d1c926530213dadd5c9fcbf59c8822da56e32a04b0f9c774d7cdde3cf6ba66d             
</span></span><span style=display:flex><span>          Description: 1 instance stopped running (from 1 to 0).                               
</span></span><span style=display:flex><span>          Reported at: Tue, 06 Sep 2022 16:53:28 CEST                                          
</span></span><span style=display:flex><span>                                                                                               
</span></span><span style=display:flex><span>#176      Artifact: 274425519734.dkr.ecr.eu-central-1.amazonaws.com/creator:b7a5908      creator   #89 
</span></span><span style=display:flex><span>          Fingerprint: 860ad172ace5aee03e6a1e3492a88b3315ecac2a899d4f159f43ca7314290d5a             
</span></span><span style=display:flex><span>          Description: 1 instance started running (from 0 to 1).                               
</span></span><span style=display:flex><span>          Reported at: Tue, 06 Sep 2022 16:52:28 CEST
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>These two snapshots belong to the same blue-green deployment.
You see artifact <code>creator:b7a5908</code> starting in snapshot #176, and artifact
<code>creator:31dee35</code> exiting in snapshot #177.</p><h2 id=dig-into-the-artifact>Dig into the artifact
<a class=anchor href=#dig-into-the-artifact>#</a></h2><p>You are interested in #176, showing the newly running artifact, <code>creator:b7a5908</code>,
with the fingerprint starting <code>860ad17</code>.</p><p>Let's learn more about this artifact:</p><div class="highlight command"><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kosli artifact get creator@860ad17
</span></span></code></pre></div><div class="highlight light-console"><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plaintext data-lang=plaintext><span style=display:flex><span>Name:        cyberdojo/creator:b7a5908
</span></span><span style=display:flex><span>Fingerprint: 860ad172ace5aee03e6a1e3492a88b3315ecac2a899d4f159f43ca7314290d5a
</span></span><span style=display:flex><span>Created on:  Tue, 06 Sep 2022 16:48:07 CEST • 21 hours ago
</span></span><span style=display:flex><span>Git commit:  b7a590836cf140e17da3f01eadd5eca17d9efc65
</span></span><span style=display:flex><span>Commit URL:  https://github.com/cyber-dojo/creator/commit/b7a590836cf140e17da3f01eadd5eca17d9efc65
</span></span><span style=display:flex><span>Build URL:   https://github.com/cyber-dojo/creator/actions/runs/3001102984
</span></span><span style=display:flex><span>State:       COMPLIANT
</span></span><span style=display:flex><span>History:  
</span></span><span style=display:flex><span>    Artifact created                               Tue, 06 Sep 2022 16:48:07 CEST
</span></span><span style=display:flex><span>    Deployment #88 to aws-beta environment         Tue, 06 Sep 2022 16:49:59 CEST
</span></span><span style=display:flex><span>    Deployment #89 to aws-prod environment         Tue, 06 Sep 2022 16:51:12 CEST
</span></span><span style=display:flex><span>    Started running in aws-beta#196 environment    Tue, 06 Sep 2022 16:51:42 CEST
</span></span><span style=display:flex><span>    Started running in aws-prod#176 environment    Tue, 06 Sep 2022 16:52:28 CEST
</span></span></code></pre></div><h2 id=follow-to-the-commit>Follow to the commit
<a class=anchor href=#follow-to-the-commit>#</a></h2><p>You can follow the <a href=https://github.com/cyber-dojo/creator/commit/b7a590836cf140e17da3f01eadd5eca17d9efc65 target=_blank>commit URL
</a>.</p><figure><img src=/images/cyber-dojo-github-diff.png alt="cyber-dojo github diff" width=500></figure><p>The incident was caused by a simple typo in the <code>app.rb</code> file!</p><p>Perhaps someone accidentally inserted the "s" while trying to save the file?
Either way, this is clearly the problem because the function is called <code>respond_to</code> without the <code>s</code>.</p><p>You were able to trace the problem back to a specific commit without any access to cyber-dojo's <code>aws-prod</code> environment.</p><h3 id=see-also-the-other-tutorials>See also the other tutorials:
<a class=anchor href=#see-also-the-other-tutorials>#</a></h3><ul><li><a href=../following_a_git_commit_to_runtime_environments/>Following a git commit to runtime environments</a></li><li><a href=../simulating_a_devops_system/>Simulating a DevOps system</a></li></ul><ul class=contents></ul></article><footer class=book-footer><hr><div class="flex justify-between flex-wrap"><div class=flex-even style=padding-right:70px><h3 class=h5-style>Get started for FREE!<br>Sign up GitHub.<br>Easy!</h3><a class="btn btn-main" href=https://app.kosli.com target=_blank>Sign up</a></div><div class=flex-even style=padding-right:70px><h3 class=h5-style>Share your feedback on the docs so we can make them easier for you to use</h3><a href=https://www.kosli.com/community/ target=_blank class="btn btn-secondary">Join the Slack Community</a></div><div class=flex-even style=padding-right:70px><h3 class=h5-style>Stuck with something?</h3><p>We have an open Slack channel where you can get in touch with the Kosli team and other users.</p><p><a href=https://www.kosli.com/community/ target=_blank>Ask the Kosli Slack community</a></p><p><a href=mailto:info@kosli.com>Email support</a></p></div></div><hr><div class="secondary-footer flex justify-between align-center flex-wrap" style=gap:15px><div><img src=/images/kosli-logo.svg alt="Kosli Logo"></div><div>© 2022 Kosli Inc.</div><div><a href=https://www.kosli.com target=_blank>kosli.com</a></div><div><a href=https://www.kosli.com/privacy-policy/ target=_blank>Privacy</a></div><div><a href=https://www.kosli.com/contact/ target=_blank>Contact Kosli</a></div><div><a href=https://www.kosli.com/pricing/ target=_blank>Pricing</a></div><div><a href=https://www.kosli.com/blog/ target=_blank>Blog</a></div><div><a href=https://www.kosli.com/about/ target=_blank>About</a></div></div><script>(function(){document.querySelectorAll("div.command").forEach(e=>{let t=document.createElement("div"),n=document.createTextNode("copied!");t.appendChild(n),e.appendChild(t),t.classList.add("copiedText"),e.addEventListener("click",function(){if(navigator.clipboard){let n=e.querySelector("code");navigator.clipboard.writeText(n.innerText),t.classList.add("visible"),setTimeout(()=>{t.classList.remove("visible")},1500)}})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#tracing-a-production-incident-back-to-git-commits>Tracing a production incident back to git commits</a><ul><li><a href=#start-with-the-environment>Start with the environment</a></li><li><a href=#dig-into-the-artifact>Dig into the artifact</a></li><li><a href=#follow-to-the-commit>Follow to the commit</a></li></ul></li></ul></nav></div></aside></main><div class=top-header><div class="container flex"><div class=docs-logo><a href=/><img src=/kosli-docs-logo-white.svg alt="Kosli docs logo"></a></div><div class=separator></div></div></div></body></html>